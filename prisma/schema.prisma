generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// --- MODELS ---

model Colaborador {
  id           String   @id @default(uuid())
  nome         String
  email        String   @unique
  cargo        String
  departamento String
  kbs          String?
  ativo        Boolean  @default(true)
  
  // Relacionamento: Um colaborador pode ter feito várias solicitações
  solicitacoes Solicitacao[] 

  criadoEm     DateTime @default(now())
  atualizadoEm DateTime @updatedAt

  @@map("colaboradores")
}

model Solicitacao {
  id                String            @id @default(uuid())
  
  // Quem pediu? (Chave Estrangeira)
  solicitanteId     String
  solicitante       Colaborador       @relation(fields: [solicitanteId], references: [id])
  
  // O que é o pedido?
  tipo              TipoSolicitacao
  status            StatusSolicitacao @default(PENDENTE_SI)
  
  // Detalhes da mudança
  colaboradorAlvo   String            // Nome ou Email de quem vai mudar de cargo
  cargoNovo         String?
  departamentoNovo  String?
  justificativa     String?
  
  // Auditoria
  criadoEm          DateTime          @default(now())
  atualizadoEm      DateTime          @updatedAt

  @@map("solicitacoes")
}

// --- ENUMS (Opções Fixas) ---

enum TipoSolicitacao {
  MUDANCA_CARGO
  NOVA_CONTRATACAO
  DESLIGAMENTO
  AJUSTE_ACESSO
}

enum StatusSolicitacao {
  PENDENTE_SI        // Esperando time de SI
  PENDENTE_GESTOR    // Esperando Gestor (após SI aprovar)
  APROVADO           // Tudo certo, pronto para executar
  RECUSADO           // Alguém negou
  PAUSADO            // Estourou o SLA de 2 dias
  CONCLUIDO          // Executado no sistema
}